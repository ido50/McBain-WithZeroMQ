#!/usr/bin/perl

=pod

Hello World client

Connects REQ socket to tcp://localhost:5559

Sends "Hello" to server, expects "World" back

Author: Daisuke Maki (lestrrat)
Original version Author: Alexander D'Archangel (darksuji) <darksuji(at)gmail(dot)com>

=cut

use lib 'lib';
use strict;
use warnings;
use 5.10.0;

use ZMQ::LibZMQ3;
use ZMQ::Constants qw(ZMQ_REQ);

my $MAX_MSGLEN = 255;

my $context = zmq_init();

# Socket to talk to server
my $requester = zmq_socket($context, ZMQ_REQ);
zmq_connect($requester, 'tcp://localhost:5559');

# send the request
zmq_send($requester, $ARGV[0], -1);

# receive the reply
my $size = zmq_recv($requester, my $buf, $MAX_MSGLEN);
my $string = $size >= 0 ? substr($buf, 0, $size) : '';
say $string;
